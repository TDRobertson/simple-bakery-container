
# Micro-Bakery Web App Docker Setup

This document provides detailed instructions for setting up, running, and maintaining the Docker-based environment for the Micro-Bakery web application. This includes Python, React, Express, Flutter, and MariaDB components.

---

## Project Structure
Here is the directory layout for the project:

```
micro-bakery-app/
├── backend/
│   ├── server.js          # Express backend server entry point
│   ├── package.json       # Backend dependencies and scripts
│   ├── node_modules/      # Backend node modules (autogenerated)
├── frontend/
│   ├── src/               # React frontend source code
│   │   ├── index.js       # Main entry point for the React app
│   ├── public/            # Static files for React
│   │   ├── index.html     # Required HTML file for React
│   ├── package.json       # Frontend dependencies and scripts
│   ├── node_modules/      # Frontend node modules (autogenerated)
├── flutter_project/       # Flutter application source code
├── db/                    # MariaDB persistent data storage (optional)
├── docker-compose.yml     # Docker Compose configuration for the app
├── Dockerfiles/
│   ├── Dockerfile.backend # Dockerfile for the Express backend
│   ├── Dockerfile.frontend # Dockerfile for the React frontend
│   ├── Dockerfile.flutter # Dockerfile for the Flutter application
└── README.md              # Project documentation
```

---

## Directory Details

### 1. `backend/`
- **Purpose**: Contains the Express backend code.
- **Required Files**:
  - `server.js`: The main entry point for the Express application.
  - `package.json`: Defines backend dependencies (e.g., `express`, `body-parser`, `nodemon`) and scripts.
  - `node_modules/`: Automatically generated after running `npm install` (not stored in version control).
- **Notes**:
  - Use `npm run dev` to enable live reload for development with tools like `nodemon`.

### 2. `frontend/`
- **Purpose**: Contains the React frontend code.
- **Required Files**:
  - `src/`: Main directory for React components, pages, and styles.
    - `index.js`: The main entry point for the React application.
  - `public/`: Static files for React (e.g., `index.html`).
    - `index.html`: The required HTML entry point for the app.
  - `package.json`: Defines frontend dependencies (e.g., `react`, `react-router-dom`, `axios`).
  - `node_modules/`: Automatically generated after running `npm install` (not stored in version control).
- **Notes**:
  - Use `npm start` for development to run the React development server.

### 3. `flutter_project/`
- **Purpose**: Contains the Flutter application code.
- **Notes**:
  - If the directory does not exist, it will be automatically created by the Flutter service in Docker when you run the container.
  - Flutter commands such as `flutter create` and `flutter run` will work within the container environment.

### 4. `db/`
- **Purpose**: Stores MariaDB data for persistence.
- **Default Setup**:
  - The `db` directory is mapped to a Docker volume by default to ensure database data persists across container restarts.
  - The data is stored in a Docker-managed volume, and not directly visible in the `db/` directory.
- **Optional Setup**:
  - If you want the database files to appear in the `db/` folder in your project directory, update `docker-compose.yml` to use a bind mount instead of a volume:
    ```yaml
    volumes:
      - ./db:/var/lib/mysql
    ```
  - Ensure the `db/` directory exists and has proper permissions:
    ```bash
    mkdir db
    chmod 777 db
    ```

### 5. `Dockerfiles/`
- **Purpose**: Contains Dockerfiles for building the frontend, backend, and Flutter containers.
- **Files**:
  - `Dockerfile.backend`: Defines the backend container configuration.
  - `Dockerfile.frontend`: Defines the frontend container configuration.
  - `Dockerfile.flutter`: Defines the Flutter container configuration.
- **Notes**:
  - All Dockerfiles are referenced in the `docker-compose.yml` file.

### 6. `docker-compose.yml`
- **Purpose**: Defines the services (frontend, backend, Flutter, and database), their configurations, and how they interact.
- **Notes**:
  - Ports are exposed for local development (3000 for React, 5000 for Express, 8080 for Flutter, 3306 for MariaDB).

---

## Setup Instructions

### 1. Prerequisites
Ensure the following tools are installed:
- Docker: [Install Docker](https://docs.docker.com/get-docker/)
- Docker Compose: [Install Docker Compose](https://docs.docker.com/compose/install/)
- Git: [Install Git](https://git-scm.com/)

### 2. Clone the Repository
```bash
git clone <repository-url>
cd micro-bakery-app
```

### 3. Build and Start the Containers
```bash
docker-compose up --build
```
- **Frontend**: Access at `http://localhost:3000`
- **Backend**: Access at `http://localhost:5000`
- **Flutter**: Access at `http://localhost:8080`
- **Database**: Accessible on port `3306` for development tools (e.g., MySQL Workbench).

### 4. Stop the Containers
To stop the running containers:
```bash
docker-compose down
```

### 5. Reset the Database (Optional)
If you need to reset the database:
```bash
docker-compose down -v
```
This removes the database volume and all data.

---

## Updating the Containers

### When to Rebuild
You must rebuild the containers if:
- You add or update dependencies in `package.json` (backend or frontend).
- You modify the `Dockerfile` for any service.

### Steps to Rebuild
1. Pull the latest changes from the repository:
   ```bash
   git pull
   ```
2. Rebuild the containers:
   ```bash
   docker-compose up --build
   ```

### Live Updates for Development
- **Frontend**: Changes in the `frontend` directory will automatically reflect when running in development mode (`npm start`).
- **Backend**: Changes in the `backend` directory will trigger a server restart when using `nodemon`.
- **Flutter**: Changes in the `flutter_project` directory will reflect when mapped correctly with Docker volumes.

---

## Environment Variables
- Use a `.env` file to define environment-specific variables (e.g., database credentials). Example:

```
MARIADB_ROOT_PASSWORD=root_password
MARIADB_DATABASE=bakerydb
MARIADB_USER=bakery_user
MARIADB_PASSWORD=user_password
```

Ensure `.env` is added to `.gitignore` to prevent sensitive information from being committed to version control.

---

## Additional Notes
- **Volumes**:
  - The default setup uses Docker-managed volumes for MariaDB, ensuring persistent storage without cluttering the local project.
  - To view the volume contents, you can use:
    ```bash
    docker volume ls
    docker run --rm -v micro_bakery_app_db:/db alpine ls /db
    ```
  - If you prefer to store database files locally, update the `docker-compose.yml` file as described in the `db/` section.
- **Collaboration**: Team members only need Docker and the repository to replicate the environment.

For any issues or questions, please refer to the project documentation or contact the team lead.
